function HikeViewModel(){var a=this;a.menuVisible=ko.observable(!1),a.openMenu=function(){a.menuVisible(!0)},a.closeMenu=function(){a.menuVisible(!1)},a.levels=["Easy","Medium","Hard","Extreme"],a.hikeList=[{name:"Elsay Lake",difficulty:"Extreme",distance:20,coords:{lat:49.415956,lng:-122.932207}},{name:"Lindsay Lake Loop",difficulty:"Hard",distance:10,coords:{lat:49.346459,lng:-122.826283}},{name:"Eagle Bluffs",difficulty:"Easy",distance:5,coords:{lat:49.387072,lng:-123.211685}},{name:"Elk Mountain",difficulty:"Medium",distance:5,coords:{lat:49.114344,lng:-121.807145}},{name:"Murrin Provincial Park",difficulty:"Easy",coords:{lat:49.646566,lng:-123.209304}},{name:"Mount Cheam Peak",difficulty:"Medium",coords:{lat:49.186288,lng:-121.682589}},{name:"Howe Sound Crest trail",difficulty:"Hard",coords:{lat:49.456665,lng:-123.188288}}],a.selectedDifficultyLevel=ko.observable(),a.getMarkerInfoContent=function(a,b){var c="<h2>"+a+"</h2>";c+="<div class='hikePhotos'>",c+="<img src='%PHOTO_URL%' />",c+="</div>";var d="https://api.flickr.com/services/rest/?method=flickr.photos.search&api_key=947cf5b151371e5150e63b4d589c58fb&text="+a+"&format=json&nojsoncallback=1";$.getJSON(d).done(function(a){var d=a.photos.photo[0];$.getJSON("https://api.flickr.com/services/rest/?method=flickr.photos.getSizes&api_key=947cf5b151371e5150e63b4d589c58fb&photo_id=PHOTO_ID&format=json&nojsoncallback=1".replace("PHOTO_ID",d.id)).done(function(a){b(c.replace("%PHOTO_URL%",a.sizes.size[4].source))}).fail(function(){alert("Error fetching photo information")})}).fail(function(){alert("Error searching flickr for photos")})},a.createMarker=function(b,c){var d=new google.maps.Marker({position:b,map:map}),e=function(b){var c=new google.maps.InfoWindow({content:b});infowindows.push(c),d.addListener("click",function(){for(var b=0;b<infowindows.length;b++)infowindows[b].close();c.open(map,this),a.bouncMarker(this)})};return a.getMarkerInfoContent(c,e),d},a.openHike=function(b){Math.max(document.documentElement.clientWidth,window.innerWidth||0)<=580&&a.menuVisible(!1);var d=markers[b.name];map.setCenter(d.getPosition()),a.bouncMarker(d);new google.maps.event.trigger(d,"click")},a.bouncMarker=function(a){a.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){a.setAnimation(null)},750)},a.setMapOnMarkers=function(a,b){for(var c=Object.values(b),d=0;d<c.length;d++)c[d].setMap(a)},a.filteredHikeList=ko.computed(function(){for(var c,b=[],d=0;d<a.hikeList.length;d++)c=a.hikeList[d],void 0!==a.selectedDifficultyLevel()&&c.difficulty!==a.selectedDifficultyLevel()||b.push(c);a.setMapOnMarkers(null,markers);for(var e=0;e<b.length;e++)c=b[e],markers[c.name]?markers[c.name].setMap(map):markers[c.name]=a.createMarker(b[e].coords,c.name);return b})}function initMap(){var a={lat:49.343056,lng:-122.801406};map=new google.maps.Map(document.getElementById("map"),{zoom:7,center:a}),ko.applyBindings(new HikeViewModel)}function gm_authFailure(){alert("Google Maps failed to load due to an authentication failure")}function mapError(){alert("General error loading a map")}var map,markers={},infowindows=[];
