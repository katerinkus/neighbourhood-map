function HikeViewModel(){var e=this;e.menuVisible=ko.observable(!1),e.openMenu=function(){e.menuVisible(!0)},e.closeMenu=function(){e.menuVisible(!1)},e.levels=["Easy","Medium","Hard","Extreme"],e.hikeList=[{name:"Elsay Lake",difficulty:"Extreme",distance:20,coords:{lat:49.415956,lng:-122.932207}},{name:"Lindsay Lake Loop",difficulty:"Hard",distance:10,coords:{lat:49.346459,lng:-122.826283}},{name:"Eagle Bluffs",difficulty:"Easy",distance:5,coords:{lat:49.387072,lng:-123.211685}},{name:"Elk Mountain",difficulty:"Medium",distance:5,coords:{lat:49.114344,lng:-121.807145}},{name:"Murrin Provincial Park",difficulty:"Easy",coords:{lat:49.646566,lng:-123.209304}},{name:"Mount Cheam Peak",difficulty:"Medium",coords:{lat:49.186288,lng:-121.682589}},{name:"Howe Sound Crest trail",difficulty:"Hard",coords:{lat:49.456665,lng:-123.188288}}],e.selectedDifficultyLevel=ko.observable(),e.getMarkerInfoContent=function(e,n){var i="<h2>"+e+"</h2>";i+="<div class='hikePhotos'>",i+="<img src='%PHOTO_URL%' />",i+="</div>";var o="https://api.flickr.com/services/rest/?method=flickr.photos.search&api_key=947cf5b151371e5150e63b4d589c58fb&text="+e+"&format=json&nojsoncallback=1",t="https://api.flickr.com/services/rest/?method=flickr.photos.getSizes&api_key=947cf5b151371e5150e63b4d589c58fb&photo_id=PHOTO_ID&format=json&nojsoncallback=1";$.getJSON(o).done(function(e){var o=e.photos.photo[0];$.getJSON(t.replace("PHOTO_ID",o.id)).done(function(e){n(i.replace("%PHOTO_URL%",e.sizes.size[4].source))}).fail(function(){alert("Error fetching photo information")})}).fail(function(){alert("Error searching flickr for photos")})},e.createMarker=function(n,i){var o=new google.maps.Marker({position:n,map:map}),t=function(e){var n=new google.maps.InfoWindow({content:e});infowindows.push(n),o.addListener("click",function(){for(var e=0;e<infowindows.length;e++)infowindows[e].close();n.open(map,this)})};return e.getMarkerInfoContent(i,t),o},e.openHike=function(n){var i=Math.max(document.documentElement.clientWidth,window.innerWidth||0);580>=i&&e.menuVisible(!1);var o=markers[n.name];map.setCenter(o.getPosition()),o.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){o.setAnimation(null)},750);new google.maps.event.trigger(o,"click")},e.setMapOnMarkers=function(e,n){for(var i=Object.values(n),o=0;o<i.length;o++)i[o].setMap(e)},e.filteredHikeList=ko.computed(function(){for(var n,i=[],o=0;o<e.hikeList.length;o++)n=e.hikeList[o],(void 0===e.selectedDifficultyLevel()||n.difficulty===e.selectedDifficultyLevel())&&i.push(n);e.setMapOnMarkers(null,markers);for(var t=0;t<i.length;t++)n=i[t],markers[n.name]?markers[n.name].setMap(map):markers[n.name]=e.createMarker(i[t].coords,n.name);return i})}function initMap(){var e={lat:49.343056,lng:-122.801406};map=new google.maps.Map(document.getElementById("map"),{zoom:8,center:e}),ko.applyBindings(new HikeViewModel)}var map,markers={},infowindows=[];
